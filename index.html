<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="skunk_logo.png" />
    <title>Welcome!</title>
    <style>
      body {
        background-color: rgb(30, 26, 52);
        font-family: "Arial", sans-serif;
        color: white;
        padding: 20px;
      }
      h1,
      h3 {
        border-bottom: 1px solid #ffffff;
        padding-bottom: 5px;
      }
      dl {
        padding: 0;
        margin: 20px 0;
      }
      dt {
        margin-top: 15px;
      }
      a {
        color: rgb(176, 133, 255);
        text-decoration: none;
      }
      a:hover {
        text-decoration: underline;
      }
      input[type="checkbox"] {
        margin-right: 10px;
      }
      .email-box {
        margin-top: 40px;
        background-color: #202040;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
      }
      textarea,
      button {
        width: 80%;
        padding: 10px;
        margin-top: 10px;
        border-radius: 5px;
        border: none;
      }
      #message {
        width: 80%;
        height: 3rem;
      }
      button {
        background-color: rgb(120, 90, 175);
        color: #202040;
        font-weight: bold;
        cursor: pointer;
      }
      button:hover {
        background-color: #e0c060;
      }
    </style>
  </head>
  <body>
    <h2>Welcome to the team,</h2>
    <dl>
      <dt>Drag sites to bookmarks bar to save them</dt>
      <br />
      <br />
      <br />
      <dl>
        <dt>
          <h3>Sites</h3>
          <dl>
            <dt>
              <a
                target="_blank"
                href="https://prod-avs-setnaio.my.salesforce.com/"
                >Salesforce</a
              >
            </dt>
          </dl>
        </dt>
        <dt>
          <h3>New Computer setup</h3>
          <dl>
            <dt>
              <input type="checkbox" id="teamsInstall" />
              <label for="teamsInstall">
                <a
                  target="_blank"
                  href="https://www.microsoft.com/en-us/microsoft-teams/download-app"
                  >Teams Install</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="ninite" />
              <label for="ninite">
                <a
                  target="_blank"
                  href="https://ninite.com/avast-chrome-teamviewer15/"
                  >Ninite - Avast, Chrome, TeamViewer 15</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="UPS" />
              <label for="UPS">
                <a
                  target="_blank"
                  href="https://www.ups.com/us/en/business-solutions/business-shipping-tools/worldship/worldship-download.page"
                  >UPS WorldShip</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="Fedex" />
              <label for="FEDEX">
                <a
                  target="_blank"
                  href="https://www.fedex.com/en-us/shipping/ship-manager/software.html#tab-4"
                  >Fedex Ship Manager</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="zebraUtility" />
              <label for="zebraUtility">
                <a
                  target="_blank"
                  href="https://www.zebra.com/us/en/support-downloads/printer-software/printer-setup-utilities.html#featureforoperatings_1457791078"
                  >Zebra Utility Download</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="brotherDownloads" />
              <label for="brotherDownloads">
                <a
                  target="_blank"
                  href="https://support.brother.com/g/b/productsearch.aspx?c=us&lang=en&content=dl"
                  >Brother | Downloads</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="DisplayLink" />
              <label for="DisplayLink">
                <a
                  target="_blank"
                  href="https://www.synaptics.com/products/displaylink-graphics/downloads/windows"
                  >DisplayLink / Synaptics</a
                >
              </label>
            </dt>
            <dt>
              <input type="checkbox" id="printNode" />
              <label for="printNode">
                <a target="_blank" href="https://www.printnode.com/en/download"
                  >PrintNode Download</a
                >
              </label>
            </dt>
          </dl>
        </dt>
      </dl>
      <dt>
        <h3>Setup Checklist</h3>
        <dl>
          <dt>
            <input type="checkbox" id="syncOneDrive" />
            <label for="syncOneDrive">Synced OneDrive</label>
          </dt>
          <dt>
            <input type="checkbox" id="access8x8" />
            <label for="access8x8">Has Access to 8x8</label>
          </dt>
          <dt>
            <input type="checkbox" id="collabFolder" />
            <label for="collabFolder">Access Collab Folder</label>
          </dt>
          <dt>
            <input type="checkbox" id="keycard" />
            <label for="keycard">Has Keycard</label>
          </dt>
          <dt>
            <input type="checkbox" id="batterySettings" />
            <label for="batterySettings">Changed Battery Settings</label>
          </dt>
          <dt>
            <input type="checkbox" id="lidSettings" />
            <label for="lidSettings">Changed Lid Settings</label>
          </dt>
          <dt>
            <input type="checkbox" id="hasWorkstation" />
            <label for="hasWorkstation">Has Workstation Ready</label>
          </dt>
          <dt>
            <input type="checkbox" id="removeMcafee" />
            <label for="removeMcafee">Removed McAfee</label>
          </dt>
          <dt>
            <input type="checkbox" id="updateMSApps" />
            <label for="updateMSApps">Updated All Microsoft Store Apps</label>
          </dt>
          <dt>
            <input type="checkbox" id="installedAllPrograms" />
            <label for="installedAllPrograms">Installed All Programs</label>
          </dt>
        </dl>
      </dt>
    </dl>
    <div class="email-box">
      <h3>Send an email to Nathan</h3>
      <form id="myForm">
        <input
          type="text"
          id="name"
          name="name"
          placeholder="Enter your name"
          style="float: right; margin-bottom: 10px"
        />
        <input
          type="text"
          id="message"
          name="message"
          placeholder="Enter your message here"
        />
        <br />
        <button type="button" onclick="sendEmail()">Send Email</button>
        <button type="button" onclick="sendCheckedEmail()">
          Send Email with Checked Items
        </button>
      </form>
    </div>

    <!-- EmailJS SDK -->
    <script
      type="text/javascript"
      src="https://cdn.emailjs.com/dist/email.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.emailjs.com/dist/email.min.js"
    ></script>
    <script type="text/javascript">
      (function () {
        emailjs.init("ecWsmMaWZQfld4_uH");
      })();

      function sendEmail() {
        var name = document.getElementById("name").value;
        var message = document.getElementById("message").value;
        var fullMessage = "<strong>Message:</strong><br/>" + message;

        var templateParams = {
          name: name, // Include the name
          message: fullMessage,
        };

        emailjs
          .send("service_u6ub1qp", "template_usermsg", templateParams)
          .then(
            function (response) {
              console.log("SUCCESS!", response.status, response.text);
              alert("Email sent successfully!");
            },
            function (error) {
              console.error("Failed to send email:", error);
              alert(
                "Failed to send the email: " + JSON.stringify(error, null, 2)
              );
            }
          );
      }

      function sendCheckedEmail() {
        console.log("Attempting to send email with checked items.");
        var name = document.getElementById("name").value;
        var introText = document.getElementById("message").value;
        var message =
          "<strong>Name:</strong> " +
          name +
          "<br/><strong>User Message:</strong><br/>" +
          introText +
          "<br/><br/>";

        var checkedItems = "<strong>Checked Items:</strong><ul>";
        var uncheckedItems = "<strong>Unchecked Items:</strong><ul>";

        var checkboxes = document.querySelectorAll('input[type="checkbox"]');
        console.log("Total checkboxes found: " + checkboxes.length);
        checkboxes.forEach(function (checkbox) {
          var labelElement = document.querySelector(
            'label[for="' + checkbox.id + '"]'
          );
          var label = labelElement
            ? labelElement.textContent.trim()
            : "Label not found for ID: " + checkbox.id;
          if (checkbox.checked) {
            checkedItems += "<li>" + label + "</li>";
          } else {
            uncheckedItems += "<li>" + label + "</li>";
          }
        });

        checkedItems += "</ul>";
        uncheckedItems += "</ul>";

        message += checkedItems + "<br/>" + uncheckedItems;
        console.log("Email Content: ", message);

        var templateParams = {
          name: name,
          message: message,
        };

        emailjs
          .send("service_u6ub1qp", "template_usermsg", templateParams)
          .then(
            function (response) {
              console.log("SUCCESS!", response.status, response.text);
              alert(
                "Email sent successfully with checked and unchecked items!"
              );
            },
            function (error) {
              console.error("Failed to send email:", error);
              alert(
                "Failed to send the email: " + JSON.stringify(error, null, 2)
              );
            }
          );
      }
    </script>
  </body>
</html>
